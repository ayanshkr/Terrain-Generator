import torch
import math
def fibonacci_sphere_torch(n, device='cuda'):
    GOLDEN_ANGLE = torch.pi * (torch.sqrt(torch.tensor(5.0, device=device)) + 1.0)
    z = torch.arange(-1.0, 1.0, 2.0 / n, dtype=torch.float64, device=device)
    r = torch.sqrt(1.0 - z * z)
    t = torch.arange(0.0, GOLDEN_ANGLE*n, GOLDEN_ANGLE, dtype=torch.float64, device=device)
    x = torch.cos(t) * r
    y = torch.sin(t) * r
    return torch.stack((x, y, z), dim=1)
